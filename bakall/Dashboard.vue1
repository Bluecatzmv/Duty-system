<script setup>
import { ref, onMounted, computed } from 'vue' 
import { useRouter } from 'vue-router'
import { 
    useMessage, NLayout, NLayoutHeader, NLayoutContent, NButton, NSpace, NTag, 
    NCard, NSpin, NModal, NForm, NFormItem, NInput, NSelect, NList, NListItem, NThing, NDatePicker, NRadioGroup, NRadio, NTimePicker, NRadioButton
} from 'naive-ui'
import request from '../utils/request'
import FullCalendar from '@fullcalendar/vue3'
import dayGridPlugin from '@fullcalendar/daygrid'
import interactionPlugin from '@fullcalendar/interaction'

const router = useRouter()
const message = useMessage()

// çŠ¶æ€
const loading = ref(false)
const calendarEvents = ref([]) 
const holidaysMap = ref({}) 
const currentUser = ref(null) 
const currentViewDate = ref(new Date())
const scheduleFileRef = ref(null)
const contactFileRef = ref(null)

// ç®¡ç†ç›¸å…³
const showUserManageModal = ref(false)
const showHolidayModal = ref(false)
const showWeComModal = ref(false)
const userList = ref([])
const newUserForm = ref({ username: '', real_name: '', password: '', role: 'admin' })

// ä¼å¾®è¡¨å•
const weComForm = ref({ webhook_url: '', message_template: '', daily_time: null })

// èŠ‚å‡æ—¥è¡¨å•
const newHolidayForm = ref({ rangeDate: null, name: '', type: 'holiday' })
const holidaysList = ref([])

// æ’ç­ç¼–è¾‘
const showEditModal = ref(false)
const editForm = ref({ id: null, staff_name: '', staff_phone: '', date: '', duty_type: '' })

const dutyOptions = [
    { label: 'æ€»å€¼ç­', value: 'æ€»å€¼ç­' }, { label: 'æŠ€æœ¯å€¼ç­', value: 'æŠ€æœ¯å€¼ç­' },
    { label: 'æ—¥é—´å€¼ç­', value: 'æ—¥é—´å€¼ç­' }, { label: 'å¤œé—´å€¼ç­', value: 'å¤œé—´å€¼ç­' },
    { label: 'å¤œé—´è§ä¹ ', value: 'å¤œé—´è§ä¹ ' }, { label: 'æ›´æ–°å€¼ç­', value: 'æ›´æ–°å€¼ç­' },
    { label: 'æ›´æ–°è§ä¹ ', value: 'æ›´æ–°è§ä¹ ' }
]
const dutyColorMap = {
    'æ€»å€¼ç­': '#d03050', 'æŠ€æœ¯å€¼ç­': '#2080f0', 'æ—¥é—´å€¼ç­': '#18a058',
    'å¤œé—´å€¼ç­': '#f0a020', 'å¤œé—´è§ä¹ ': '#8a2be2', 'æ›´æ–°å€¼ç­': '#00bcd4', 'æ›´æ–°è§ä¹ ': '#9e9e9e'
}
const dutyLabelMap = {
    'æ€»å€¼ç­': '[æ€»]', 'æŠ€æœ¯å€¼ç­': '[æŠ€]', 'æ—¥é—´å€¼ç­': '[æ—¥]', 'å¤œé—´å€¼ç­': '[å¤œ]',
    'å¤œé—´è§ä¹ ': '[å¤œè§]', 'æ›´æ–°å€¼ç­': '[æ›´]', 'æ›´æ–°è§ä¹ ': '[æ›´è§]'
}
const dutyRankMap = {
    'æ€»å€¼ç­': 1, 'æŠ€æœ¯å€¼ç­': 2, 'æ—¥é—´å€¼ç­': 3, 'å¤œé—´å€¼ç­': 4,
    'å¤œé—´è§ä¹ ': 5, 'æ›´æ–°å€¼ç­': 6, 'æ›´æ–°è§ä¹ ': 7
}

const isAdmin = computed(() => {
    return currentUser.value && (currentUser.value.role === 'admin' || currentUser.value.role === 'super_admin')
})

const formatDateLocal = (dateObj) => {
    const year = dateObj.getFullYear()
    const month = String(dateObj.getMonth() + 1).padStart(2, '0')
    const day = String(dateObj.getDate()).padStart(2, '0')
    return `${year}-${month}-${day}`
}

const calendarOptions = ref({
    plugins: [dayGridPlugin, interactionPlugin],
    initialView: 'dayGridMonth',
    locale: 'zh-cn',
    firstDay: 1,
    headerToolbar: { left: 'prev,next today', center: 'title', right: '' },
    eventDisplay: 'block', events: calendarEvents,
    eventOrder: 'rank', datesSet: handleDatesSet, 
    eventClick: handleEventClick,
    dayCellContent: (arg) => {
        const dateStr = formatDateLocal(arg.date)
        const holiday = holidaysMap.value[dateStr]
        const dayNumber = arg.dayNumberText
        let html = `<div class="fc-daygrid-day-number">${dayNumber}</div>`
        
        if (holiday) {
            if (holiday.type === 'holiday') {
                html += `<div class="holiday-tag holiday">ä¼‘</div><div class="holiday-name holiday-text">${holiday.name}</div>`
            } else if (holiday.type === 'workday') {
                html += `<div class="holiday-tag workday">ç­</div><div class="holiday-name workday-text">${holiday.name}</div>`
            } else if (holiday.type === 'guarantee') {
                // é‡ç‚¹ä¿éšœæœŸï¼šæ ·å¼æ›´é†’ç›®
                html += `<div class="holiday-tag guarantee">ä¿</div><div class="holiday-name guarantee-text">${holiday.name}</div>`
            }
        }
        return { html: html }
    }
})

onMounted(async () => { await fetchUserInfo() })

async function fetchUserInfo() {
    const token = localStorage.getItem('token')
    if(!token) { currentUser.value = null; return }
    try {
        const payload = JSON.parse(atob(token.split('.')[1]))
        currentUser.value = { role: payload.role, username: payload.sub }
    } catch(e) { currentUser.value = null }
}

function handleEventClick(info) {
    if (!isAdmin.value) { message.info("è¯·ç™»å½•åè¿›è¡Œä¿®æ”¹æ“ä½œ"); return }
    const props = info.event.extendedProps
    editForm.value = {
        id: props.id, staff_name: props.staff_name, staff_phone: props.staff_phone,
        date: info.event.startStr, duty_type: props.duty_type
    }
    showEditModal.value = true
}

function goToLogin() { router.push('/login') }
function handleLogout() { localStorage.clear(); currentUser.value = null; message.success("å·²é€€å‡ºç™»å½•") }

async function openUserManage() { showUserManageModal.value = true; userList.value = await request.get('/users/') }
async function createUser() {
    if(!newUserForm.value.username || !newUserForm.value.password) return message.warning("è¯·å¡«å†™å®Œæ•´")
    try {
        await request.post('/users/', newUserForm.value); message.success("åˆ›å»ºæˆåŠŸ"); 
        userList.value = await request.get('/users/'); newUserForm.value = { username: '', real_name: '', password: '', role: 'admin' }
    } catch (e) { message.error(e.response?.data?.detail) }
}
async function deleteUser(id) { try { await request.delete(`/users/${id}`); message.success("å·²åˆ é™¤"); userList.value = await request.get('/users/') } catch {} }

async function openHolidayManage() {
    showHolidayModal.value = true
    const year = currentViewDate.value.getFullYear()
    const month = currentViewDate.value.getMonth() + 1
    holidaysList.value = await request.get('/holidays/', { params: {year, month} })
}

async function openWeComSettings() {
    showWeComModal.value = true
    try {
        const res = await request.get('/config/wecom')
        weComForm.value = res
    } catch (e) { message.error("è·å–é…ç½®å¤±è´¥") }
}
async function saveWeComSettings() {
    try {
        await request.post('/config/wecom', weComForm.value)
        message.success("ä¿å­˜æˆåŠŸ")
        showWeComModal.value = false
    } catch (e) { message.error("ä¿å­˜å¤±è´¥") }
}
async function testSendWeCom() {
    try {
        const res = await request.post('/notify/send')
        if (res.status === 'success') message.success("å‘é€æˆåŠŸ")
        else message.error(res.message)
    } catch (e) { message.error("å‘é€å¤±è´¥") }
}

async function createHolidayBatch() {
    if(!newHolidayForm.value.rangeDate || !newHolidayForm.value.name) return message.warning("è¯·é€‰æ‹©æ—¥æœŸèŒƒå›´å¹¶å¡«å†™åç§°")
    const [startTs, endTs] = newHolidayForm.value.rangeDate
    const fmt = (ts) => formatDateLocal(new Date(ts))
    const payload = { start_date: fmt(startTs), end_date: fmt(endTs), name: newHolidayForm.value.name, type: newHolidayForm.value.type }
    try {
        await request.post('/holidays/batch', payload)
        message.success("è®¾ç½®æˆåŠŸ")
        const year = currentViewDate.value.getFullYear()
        const month = currentViewDate.value.getMonth() + 1
        holidaysList.value = await request.get('/holidays/', { params: {year, month} })
        fetchSchedules(year, month)
    } catch (e) { message.error("è®¾ç½®å¤±è´¥: " + e.message) }
}

async function deleteHoliday(id) {
    try { 
        await request.delete(`/holidays/${id}`)
        message.success("å·²åˆ é™¤")
        const year = currentViewDate.value.getFullYear()
        const month = currentViewDate.value.getMonth() + 1
        holidaysList.value = await request.get('/holidays/', { params: {year, month} })
        fetchSchedules(year, month)
    } catch {}
}

async function saveScheduleChange() {
    try {
        await request.put(`/schedules/${editForm.value.id}`, editForm.value); message.success("æ›´æ–°æˆåŠŸ"); 
        showEditModal.value = false; fetchSchedules(currentViewDate.value.getFullYear(), currentViewDate.value.getMonth() + 1)
    } catch (e) { message.error("æ›´æ–°å¤±è´¥") }
}
async function deleteSchedule() {
    if(!window.confirm("ç¡®å®šåˆ é™¤ï¼Ÿ")) return
    try { await request.delete(`/schedules/${editForm.value.id}`); message.success("å·²åˆ é™¤"); showEditModal.value = false; fetchSchedules(currentViewDate.value.getFullYear(), currentViewDate.value.getMonth() + 1) } catch {}
}

function triggerScheduleUpload() { if (scheduleFileRef.value) scheduleFileRef.value.click() }
function triggerContactUpload() { if (contactFileRef.value) contactFileRef.value.click() }
async function handleScheduleUpload(event) {
    const file = event.target.files[0]; if (!file) return; if (!window.confirm(`å¯¼å…¥æ’ç­è¡¨ï¼š${file.name}ï¼Ÿ`)) return; await uploadFile('/schedules/import_excel', file)
}
async function handleContactUpload(event) {
    const file = event.target.files[0]; if (!file) return; if (!window.confirm(`å¯¼å…¥é€šè®¯å½•ï¼š${file.name}ï¼Ÿ`)) return; await uploadFile('/contacts/import', file)
}
async function uploadFile(url, file) {
    loading.value = true
    try {
        const formData = new FormData(); formData.append('file', file)
        await request.post(url, formData, { headers: { 'Content-Type': 'multipart/form-data' } })
        message.success("å¯¼å…¥æˆåŠŸ")
        fetchSchedules(currentViewDate.value.getFullYear(), currentViewDate.value.getMonth() + 1)
    } catch (e) { message.error("å¯¼å…¥å¤±è´¥: " + e.message) }
    finally { loading.value = false; scheduleFileRef.value.value = ''; contactFileRef.value.value = '' }
}

function handleDatesSet(arg) {
    const midDate = new Date(arg.start.getTime() + (arg.end.getTime() - arg.start.getTime()) / 2)
    currentViewDate.value = midDate
    fetchSchedules(midDate.getFullYear(), midDate.getMonth() + 1)
}

async function fetchSchedules(year, month) {
    loading.value = true
    try {
        const [schedulesRes, holidaysRes] = await Promise.all([
            request.get('/schedules/', { params: { year, month } }),
            request.get('/holidays/', { params: { year, month } })
        ])
        const hMap = {}; holidaysRes.forEach(h => { hMap[h.date] = h }); holidaysMap.value = hMap

        const techDutyMap = new Set()
        schedulesRes.forEach(item => { if (item.duty_type === 'æŠ€æœ¯å€¼ç­') techDutyMap.add(`${item.date}_${item.staff_name}`) })

        const events = []
        schedulesRes.forEach(item => {
            if (item.duty_type === 'æ—¥é—´å€¼ç­') {
                const key = `${item.date}_${item.staff_name}`; if (techDutyMap.has(key)) return 
            }
            const phoneStr = item.staff_phone ? ` ${item.staff_phone}` : ''
            const prefix = dutyLabelMap[item.duty_type] || `[${item.duty_type.substring(0,1)}]`
            events.push({
                title: `${prefix} ${item.staff_name}${phoneStr}`,
                start: item.date,
                color: dutyColorMap[item.duty_type] || '#555',
                extendedProps: {
                    rank: dutyRankMap[item.duty_type] || 99,
                    id: item.id, staff_name: item.staff_name, staff_phone: item.staff_phone, duty_type: item.duty_type
                }
            })
        })
        calendarEvents.value = events
    } catch (err) { } finally { loading.value = false }
}

// è¾…åŠ©å‡½æ•°ï¼šæ ¹æ®ç±»å‹è¿”å›ä¸­æ–‡
function getHolidayTypeLabel(type) {
    if (type === 'holiday') return 'ä¼‘'
    if (type === 'workday') return 'ç­'
    if (type === 'guarantee') return 'ä¿'
    return '?'
}
// è¾…åŠ©å‡½æ•°ï¼šæ ‡ç­¾ç±»å‹
function getHolidayTagType(type) {
    if (type === 'holiday') return 'error'
    if (type === 'workday') return 'default'
    if (type === 'guarantee') return 'warning'
    return 'default'
}
</script>

<template>
  <div class="dashboard-container">
    <n-layout style="height: 100vh; background: transparent;">
      <n-layout-header class="nav-header">
        <div class="brand">
          <span class="logo-text">æŒ‡æŒ¥ä¸­å¿ƒæ’ç­ç³»ç»Ÿ</span>
          <n-tag v-if="isAdmin" type="success" size="small" round bordered>ç®¡ç†æ¨¡å¼</n-tag>
          <n-tag v-else type="default" size="small" round bordered>åªè¯»æ¨¡å¼</n-tag>
        </div>
        <div class="nav-controls">
          <n-space align="center">
            <n-button strong secondary type="info" @click="router.push('/stats')">ğŸ“Š æ•°æ®åˆ†æ</n-button>
            <n-button strong secondary type="warning" @click="router.push('/compensatory')">ğŸ›Œ è°ƒä¼‘ç®¡ç†</n-button>
            <template v-if="isAdmin">
                <n-button strong secondary type="info" @click="openWeComSettings">ğŸ¤– ä¼å¾®é€šçŸ¥è®¾ç½®</n-button>
                <n-button strong secondary type="error" @click="openHolidayManage">ğŸ“… èŠ‚å‡æ—¥ä¸ä¿éšœæœŸ</n-button>
                <n-button v-if="currentUser.role === 'super_admin'" strong secondary type="success" @click="openUserManage">ğŸ‘¥ è´¦å·ç®¡ç†</n-button>
                <input type="file" ref="scheduleFileRef" style="display: none" accept=".xlsx" @change="handleScheduleUpload"/>
                <input type="file" ref="contactFileRef" style="display: none" accept=".xlsx" @change="handleContactUpload"/>
                <n-button type="info" ghost @click="triggerContactUpload">ğŸ“’ å¯¼å…¥é€šè®¯å½•</n-button>
                <n-button type="warning" ghost @click="triggerScheduleUpload">ğŸ“… å¯¼å…¥æ’ç­è¡¨</n-button>
                <n-button size="small" type="error" ghost @click="handleLogout">é€€å‡ºç™»å½•</n-button>
            </template>
            <template v-else><n-button type="primary" @click="goToLogin">ğŸ”‘ ç®¡ç†å‘˜ç™»å½•</n-button></template>
          </n-space>
        </div>
      </n-layout-header>

      <n-layout-content content-style="padding: 24px; background: transparent;">
        <n-spin :show="loading" description="åŠ è½½ä¸­...">
            <n-card class="calendar-card" :bordered="false">
                <FullCalendar :options="calendarOptions" class="duty-calendar" />
            </n-card>
        </n-spin>
      </n-layout-content>
    </n-layout>
    
    <template v-if="isAdmin">
        <n-modal v-model:show="showWeComModal" preset="card" title="ä¼ä¸šå¾®ä¿¡é€šçŸ¥è®¾ç½®" style="width: 500px">
            <n-form>
                <n-form-item label="Webhook åœ°å€">
                    <n-input v-model:value="weComForm.webhook_url" placeholder="https://qyapi.weixin.qq.com/..." />
                </n-form-item>
                <n-form-item label="æ¶ˆæ¯æ¨¡æ¿">
                    <n-input v-model:value="weComForm.message_template" type="textarea" :rows="5" placeholder="è¯·å¡«å…¥æ¨¡æ¿å†…å®¹..." />
                </n-form-item>
                <n-form-item label="æ¯æ—¥è‡ªåŠ¨å‘é€æ—¶é—´ (ç•™ç©ºåˆ™å…³é—­)">
                    <n-time-picker v-model:formatted-value="weComForm.daily_time" format="HH:mm" value-format="HH:mm" placeholder="é€‰æ‹©æ—¶é—´ (å¦‚ 09:00)" style="width: 100%" clearable />
                </n-form-item>
                <div style="display: flex; justify-content: space-between;">
                    <n-button type="warning" ghost @click="testSendWeCom">ğŸ“¨ ç«‹å³å‘é€ä¸€æ¡æµ‹è¯•é€šçŸ¥</n-button>
                    <div style="display: flex; gap: 10px;">
                        <n-button @click="showWeComModal = false">å–æ¶ˆ</n-button>
                        <n-button type="primary" @click="saveWeComSettings">ä¿å­˜é…ç½®</n-button>
                    </div>
                </div>
            </n-form>
        </n-modal>

        <n-modal v-model:show="showUserManageModal" preset="card" title="è´¦å·ç®¡ç†" style="width: 600px">
            <n-card :bordered="false" title="æ·»åŠ æ–°ç®¡ç†å‘˜" size="small" style="margin-bottom: 20px;">
                <n-space vertical>
                    <n-input v-model:value="newUserForm.username" placeholder="ç™»å½•è´¦å·" />
                    <n-input v-model:value="newUserForm.real_name" placeholder="çœŸå®å§“å" />
                    <n-input v-model:value="newUserForm.password" type="password" placeholder="å¯†ç " />
                    <n-button type="primary" block @click="createUser">åˆ›å»ºè´¦å·</n-button>
                </n-space>
            </n-card>
            <n-list bordered>
                <n-list-item v-for="u in userList" :key="u.id">
                    <n-thing :title="u.real_name" :description="u.role" />
                    <template #suffix><n-button v-if="u.role !== 'super_admin'" size="small" type="error" @click="deleteUser(u.id)">åˆ é™¤</n-button></template>
                </n-list-item>
            </n-list>
        </n-modal>

        <n-modal v-model:show="showHolidayModal" preset="card" title="èŠ‚å‡æ—¥ä¸ä¿éšœæœŸè®¾ç½®" style="width: 550px">
            <n-card :bordered="false" size="small" style="margin-bottom: 20px; background: #f9f9f9;">
                <n-space vertical>
                    <n-date-picker v-model:value="newHolidayForm.rangeDate" type="daterange" placeholder="é€‰æ‹©æ—¥æœŸèŒƒå›´" style="width: 100%" clearable />
                    <n-input v-model:value="newHolidayForm.name" placeholder="åç§° (å¦‚: ä¸¤ä¼šæœŸé—´ã€æ˜¥èŠ‚)" />
                    <n-radio-group v-model:value="newHolidayForm.type">
                        <n-radio-button value="holiday" label="ä¼‘ (æ³•å®šèŠ‚å‡æ—¥)" />
                        <n-radio-button value="workday" label="ç­ (è°ƒä¼‘è¡¥ç­)" />
                        <n-radio-button value="guarantee" label="ä¿ (é‡è¦ä¿éšœæœŸ)" />
                    </n-radio-group>
                    <n-button type="primary" block @click="createHolidayBatch">æ·»åŠ /ä¿®æ”¹</n-button>
                </n-space>
            </n-card>
            <div style="max-height: 300px; overflow-y: auto;">
                <n-list bordered>
                    <n-list-item v-for="h in holidaysList" :key="h.id">
                        <n-space justify="space-between" align="center">
                            <div>
                                <n-tag :type="getHolidayTagType(h.type)" size="small" style="margin-right: 8px">{{ getHolidayTypeLabel(h.type) }}</n-tag>
                                <span style="font-weight: bold; margin-right: 8px;">{{ h.date }}</span>
                                <span>{{ h.name }}</span>
                            </div>
                            <n-button size="small" type="error" ghost @click="deleteHoliday(h.id)">åˆ é™¤</n-button>
                        </n-space>
                    </n-list-item>
                </n-list>
            </div>
        </n-modal>

        <n-modal v-model:show="showEditModal" preset="card" title="è°ƒæ•´æ’ç­" style="width: 400px">
            <n-form>
                <n-form-item label="å€¼ç­äººå‘˜"><n-input v-model:value="editForm.staff_name" /></n-form-item>
                <n-form-item label="è”ç³»ç”µè¯"><n-input v-model:value="editForm.staff_phone" /></n-form-item>
                <n-form-item label="æ—¥æœŸ"><n-input type="date" v-model:value="editForm.date" /></n-form-item>
                <n-form-item label="å²—ä½ç±»å‹"><n-select v-model:value="editForm.duty_type" :options="dutyOptions" /></n-form-item>
                <n-space justify="end">
                    <n-button type="error" ghost @click="deleteSchedule">åˆ é™¤</n-button>
                    <n-button type="primary" @click="saveScheduleChange">ä¿å­˜ä¿®æ”¹</n-button>
                </n-space>
            </n-form>
        </n-modal>
    </template>
  </div>
</template>

<style>
/* æ—¥å†æ ¼å­åŸºç¡€æ ·å¼ */
.fc-day-sat, .fc-day-sun { background-color: #fcfcfc !important; }

/* èŠ‚å‡æ—¥æ ‡ç­¾é€šç”¨ */
.holiday-tag { position: absolute; top: 4px; right: 4px; font-size: 12px; padding: 1px 4px; border-radius: 4px; font-weight: bold; line-height: 1; z-index: 5; }
.holiday-name { position: absolute; top: 6px; right: 32px; font-size: 12px; font-weight: bold; z-index: 5; }

/* 1. ä¼‘ (æ³•å®šèŠ‚å‡æ—¥) - ç²‰çº¢/çº¢ */
.holiday-tag.holiday { color: #d03050; background: rgba(208, 48, 80, 0.1); border: 1px solid rgba(208, 48, 80, 0.2); }
.holiday-text { color: #d03050; }

/* 2. ç­ (è°ƒä¼‘è¡¥ç­) - ç°è‰² */
.holiday-tag.workday { color: #666; background: #eee; border: 1px solid #ddd; }
.workday-text { color: #666; }

/* 3. ä¿ (é‡è¦ä¿éšœæœŸ) - ç´«è‰²/é‡‘è‰² - é†’ç›® */
.holiday-tag.guarantee { 
    color: #fff; 
    background: linear-gradient(135deg, #6600cc 0%, #a855f7 100%); 
    border: 1px solid #6600cc; 
    box-shadow: 0 2px 4px rgba(102, 0, 204, 0.3);
}
.guarantee-text { color: #6600cc; font-weight: 800; }

/* å…¶ä»–æ ·å¼ */
.dashboard-container { background-color: #f5f7fa; min-height: 100vh; color: #333; }
.nav-header { height: 64px; padding: 0 32px; display: flex; justify-content: space-between; align-items: center; background: #ffffff; border-bottom: 1px solid #e1e4e8; box-shadow: 0 2px 6px rgba(0,0,0,0.02); }
.brand { display: flex; align-items: center; gap: 12px; }
.logo-text { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; font-size: 20px; font-weight: 800; color: #2c3e50; letter-spacing: 0.5px; }
.calendar-card { background: #ffffff !important; border: 1px solid #ebeef5; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); }
.fc { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; color: #2c3e50; }
.fc-theme-standard td, .fc-theme-standard th { border-color: #e6e6e6; }
.fc-col-header-cell-cushion { color: #555; font-weight: 600; padding: 10px 0; }
.fc-daygrid-day-number { color: #333; font-size: 18px; font-weight: 700; margin: 8px; text-decoration: none !important; font-family: 'Helvetica Neue', sans-serif; position: relative; z-index: 2; }
.fc-day-today { background-color: rgba(32, 128, 240, 0.05) !important; }
.fc-day-today .fc-daygrid-day-number { color: #2080f0; font-size: 20px; }
.fc-event { border: none; margin-top: 3px; margin-bottom: 3px; font-size: 12px; font-weight: 500; cursor: pointer; box-shadow: 0 1px 2px rgba(0,0,0,0.1); border-radius: 4px; padding: 2px 4px; }
.fc-toolbar-title { font-size: 24px !important; font-weight: 700; color: #2c3e50; }
.fc-button { background-color: #f5f5f5 !important; border-color: #d9d9d9 !important; color: #333 !important; font-weight: 600; }
.fc-button-active { background-color: #2080f0 !important; color: #fff !important; border-color: #2080f0 !important; }
</style>
